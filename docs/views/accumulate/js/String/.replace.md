---
title: .replace方法
---

> replace() 方法返回一个由替换值（replacement）替换部分或所有的模式（pattern）匹配项后的新字符串。

> 模式可以是一个字符串或者一个正则表达式，替换值可以是一个字符串或者一个每次匹配都要调用的回调函数。

> __如果pattern是字符串，则仅替换第一个匹配项。__

``` js
const str = 'a,b,c,d'
console.log(str.replace('a','b'))
// result: 'b,b,c,d'

const regex_1 = /,/i
console.log(str.replace(regex_1,''))
// result: 'ab,c,d'

const regex_2 = /,/g
console.log(str.replace(regex_2,''))
// result: 'abcd'


```

> __语法__
>
>> str.replace(regexp|substr, newSubStr|function)

> __参数__

> regexp (pattern)
>
>> 一个RegExp 对象或者其字面量。该正则所匹配的内容会被第二个参数的返回值替换掉。

> substr (pattern)
>
>> 一个将被 newSubStr 替换的 字符串。其被视为一整个字符串，而不是一个正则表达式。仅第一个匹配项会被替换。

> newSubStr (replacement)
>
>> 用于替换掉第一个参数在原字符串中的匹配部分的字符串。该字符串中可以内插一些特殊的变量名。参考下面的使用字符串作为参数。

> function (replacement)
>
>> 一个用来创建新子字符串的函数，该函数的返回值将替换掉第一个参数匹配到的结果。参考下面的指定一个函数作为参数。

> __返回值__
>
>> 一个部分或全部匹配由替代模式所取代的新的字符串。

> __描述__
>
>> 该方法并不改变调用它的字符串本身，而只是返回一个新的替换后的字符串。
>>
>> 在进行全局的搜索替换时，正则表达式需包含 g 标志。

> __指定一个函数作为参数__
>
>> 你可以指定一个函数作为第二个参数。在这种情况下，当匹配执行后，该函数就会执行。 函数的返回值作为替换字符串。 (注意：上面提到的特殊替换参数在这里不能被使用。) 另外要注意的是，如果第一个参数是正则表达式，并且其为全局匹配模式，那么这个方法将被多次调用，每次匹配都会被调用。

> __在 replace() 中使用 global 和 ignore 选项__
>
>> 正则表达式包含有全局替换 (g) 和忽略大小写 (i) 的选项，这使得 replace 方法用'oranges'替换掉了所有出现的"apples","Apples".

> __交换字符串中的两个单词__
>
>> 下面的例子演示了如何交换一个字符串中两个单词的位置，这个脚本使用$1 和 $2 代替替换文本。

``` js
var re = /(\w+)\s(\w+)/;
var str = "John Smith";
var newstr = str.replace(re, "$2, $1");
// Smith, John
console.log(newstr);
```

> __使用行内函数来修改匹配到的字符。__
>
>> 在这个例子中，所有出现的大写字母转换为小写，并且在匹配位置前加一个连字符。重要的是，在返回一个替换了的字符串前，在匹配元素前进行添加操作是必要的。
>
>> 在返回前，替换函数允许匹配片段作为参数，并且将它和连字符进行连接作为新的片段。

``` js
function styleHyphenFormat(propertyName) {
  function upperToHyphenLower(match) {
    return '-' + match.toLowerCase();
  }
  return propertyName.replace(/[A-Z]/g, upperToHyphenLower);
}
```

> 运行 styleHyphenFormat('borderTop')，将返回 'border-top'。

> 因为我们想在最终的替换中进一步转变匹配结果，所以我们必须使用一个函数。这迫使我们在使用toLowerCase()方法前进行评估。如果我们尝试不用一个函数进行匹配，那么使用toLowerCase() 方法将不会有效。

``` js
var newString = propertyName.replace(/[A-Z]/g, '-' + '$&'.toLowerCase());  // won't work
```

> 这是因为 '$&'.toLowerCase() 会先被解析成字符串字面量（这会导致相同的'$&') 而不是当作一个模式。

> __将华氏温度转换为对等的摄氏温度__
>
>> 下面的例子演示如何将华氏温度转换为对等的摄氏温度。华氏温度用一个数字加一个"F"来表示，这个函数将返回一个数字加"C"来表示的摄氏温度。例如，如果输入是 212F，这个函数将返回 100C。如果输入的数字是 0F，这个方法将返回 "-17.77777777777778C"。

> 正则表达式 test 检查任何数字是否以 F 结尾。华氏温度通过第二个参数 p1 进入函数。这个函数基于华氏温度作为字符串传递给 f2c 函数设置成摄氏温度。然后 f2c() 返回摄氏温度。这个函数与 Perl 的 s///e 标志相似。

``` js
function f2c(x)
{
  function convert(str, p1, offset, s)
  {
    return ((p1-32) * 5/9) + "C";
  }
  var s = String(x);
  var test = /(\d+(?:\.\d*)?)F\b/g;
  return s.replace(test, convert);
}
```

